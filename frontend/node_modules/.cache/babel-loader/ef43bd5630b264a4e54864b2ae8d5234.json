{"ast":null,"code":"var _jsxFileName = \"/Users/IuliiaSaprykina/Development/code/Mod4/Projects/meal_app/frontend/src/App.js\";\nimport React, { Component } from 'react';\nimport './App.css';\nimport PrivateRoute from './components/PrivateRoute';\nimport Login from './components/Login';\nimport { Route, Switch, Redirect } from \"react-router-dom\";\nimport Signup from './components/Signup';\nimport Favorites from \"./components/Favorites\";\n\n((nm, tm) => {\n  const lStorage = localStorage;\n  const sStorage = sessionStorage;\n\n  const tabId = sStorage.getItem(tm) || (newId => {\n    sStorage.setItem(tm, newId);\n    return newId;\n  })((Math.random() * 1e8).toFixed());\n\n  const update = setTabValue => {\n    let currentValue = JSON.parse(lStorage.getItem(nm) || '{}');\n    const arrValue = Object.values(currentValue);\n\n    if (setTabValue && typeof currentValue[tabId] === 'undefined' && !arrValue.reduce((sum, current) => {\n      return sum + current;\n    }, 0)) {\n      lStorage.clear();\n      currentValue = {};\n    }\n\n    currentValue[tabId] = setTabValue;\n    lStorage.setItem(nm, JSON.stringify(currentValue));\n  };\n\n  update(1);\n\n  window.onbeforeunload = () => {\n    update(0);\n  };\n})('tabs', 'tabid');\n\nconst recipesUrl = \"http://localhost:3000/recipes/\";\nconst favoritesUrl = \"http://localhost:3000/user_recipes/\";\nexport default class App extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      favorites: [],\n      recipes: []\n    };\n\n    this.getRecipes = () => {\n      fetch(recipesUrl).then(response => response.json()).then(response => this.setState({\n        recipes: response\n      }));\n    };\n\n    this.getFavorites = () => {\n      fetch(favoritesUrl, {\n        method: 'GET',\n        headers: {\n          'Accept': 'application/json',\n          'Authorization': `Bearer ${localStorage.getItem(\"token\")}`\n        }\n      }).then(response => response.json()).then(result => this.setState({\n        favorites: result\n      }));\n    };\n\n    this.addToFavorite = (recipeId, userId) => {\n      const favorite = {\n        userRecipe: {\n          recipe_id: recipeId,\n          user_id: +userId\n        }\n      };\n      console.log(favorite);\n      this.setState({\n        favorites: [...this.state.favorites, favorite]\n      });\n      fetch(favoritesUrl, {\n        method: 'POST',\n        headers: {\n          'Content-type': 'application/json',\n          'Accept': 'application/json',\n          'Authorization': `Bearer ${localStorage.getItem(\"token\")}`\n        },\n        body: JSON.stringify(favorite)\n      });\n    };\n\n    this.addRecipe = recipe => {\n      this.setState({\n        recipes: [...this.state.recipes, recipe]\n      });\n      fetch(recipesUrl, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(recipe)\n      }).then(response => response.json()).then(recipe => {\n        this.addToFavorite(recipe.id, localStorage.getItem(\"user_id\"));\n      });\n    };\n  }\n\n  componentDidMount() {\n    this.getRecipes();\n    this.getFavorites();\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Switch, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Route, {\n      path: \"/login\",\n      render: props => /*#__PURE__*/React.createElement(Login, Object.assign({}, props, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 51\n        }\n      })),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      path: \"/signup\",\n      render: props => /*#__PURE__*/React.createElement(Signup, Object.assign({}, props, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 52\n        }\n      })),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      path: \"/favorites\",\n      render: props => /*#__PURE__*/React.createElement(Favorites, Object.assign({\n        favorites: this.state.favorites\n      }, props, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 55\n        }\n      })),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(PrivateRoute, {\n      exact: true,\n      path: \"/\",\n      addRecipe: this.addRecipe,\n      addToFavorite: this.addToFavorite,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      render: () => /*#__PURE__*/React.createElement(Redirect, {\n        to: \"/\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 32\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 11\n      }\n    })));\n  }\n\n}","map":{"version":3,"sources":["/Users/IuliiaSaprykina/Development/code/Mod4/Projects/meal_app/frontend/src/App.js"],"names":["React","Component","PrivateRoute","Login","Route","Switch","Redirect","Signup","Favorites","nm","tm","lStorage","localStorage","sStorage","sessionStorage","tabId","getItem","newId","setItem","Math","random","toFixed","update","setTabValue","currentValue","JSON","parse","arrValue","Object","values","reduce","sum","current","clear","stringify","window","onbeforeunload","recipesUrl","favoritesUrl","App","state","favorites","recipes","getRecipes","fetch","then","response","json","setState","getFavorites","method","headers","result","addToFavorite","recipeId","userId","favorite","userRecipe","recipe_id","user_id","console","log","body","addRecipe","recipe","id","componentDidMount","render","props"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport './App.css';\nimport PrivateRoute from './components/PrivateRoute';\nimport Login from './components/Login';\nimport { Route, Switch, Redirect } from \"react-router-dom\"\nimport Signup from './components/Signup';\nimport Favorites from \"./components/Favorites\";\n\n\n((nm, tm) => {\n  const lStorage = localStorage;\n  const sStorage = sessionStorage;\n  const tabId = sStorage.getItem(tm)\n    || ((newId) => {\n      sStorage.setItem(tm, newId);\n      return newId;\n    })((Math.random() * 1e8).toFixed());\n  const update = (setTabValue) => {\n    let currentValue = JSON.parse(lStorage.getItem(nm) || '{}');\n    const arrValue: number[] = Object.values(currentValue);\n    if (setTabValue\n      && typeof currentValue[tabId] === 'undefined'\n      && !arrValue.reduce((sum, current) => { return sum + current; }, 0)) {\n      lStorage.clear();\n      currentValue = {};\n    }\n    currentValue[tabId] = setTabValue;\n    lStorage.setItem(nm, JSON.stringify(currentValue));\n  };\n  update(1);\n  window.onbeforeunload = () => { update(0); };\n})('tabs', 'tabid');\n\nconst recipesUrl = \"http://localhost:3000/recipes/\";\nconst favoritesUrl = \"http://localhost:3000/user_recipes/\"\n\n\nexport default class App extends Component {\n\n  state = {\n    favorites: [],\n    recipes: []\n  }\n\n  componentDidMount(){\n    this.getRecipes();\n    this.getFavorites();\n  }\n\n  getRecipes = () => {\n    fetch(recipesUrl)\n    .then(response => response.json())\n    .then(response => this.setState({\n      recipes: response\n    }))\n  }\n\n  getFavorites = () => {\n    fetch(favoritesUrl, { \n      method: 'GET',\n      headers: {\n        'Accept': 'application/json',\n        'Authorization': `Bearer ${localStorage.getItem(\"token\")}`\n      }\n    })\n      .then(response => response.json())\n      .then(result => this.setState({favorites: result}))\n  }\n\n  addToFavorite = (recipeId, userId) => {\n    const favorite = {\n      userRecipe:{\n        recipe_id: recipeId,\n        user_id: +userId\n      }\n    }\n    console.log(favorite)\n    this.setState({\n      favorites: [...this.state.favorites, favorite]\n    })\n\n    fetch(favoritesUrl, {\n      method: 'POST',\n      headers: {\n        'Content-type' : 'application/json',\n        'Accept': 'application/json',\n        'Authorization': `Bearer ${localStorage.getItem(\"token\")}`\n      },\n      body: JSON.stringify(favorite)\n    })\n  }\n\n  addRecipe = (recipe) => {\n    this.setState({\n      recipes: [...this.state.recipes, recipe]\n    })\n\n    fetch(recipesUrl, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(recipe)\n    })\n      .then(response => response.json())\n      .then(recipe => {\n        this.addToFavorite(recipe.id, localStorage.getItem(\"user_id\"))\n      })\n  }\n\n  render(){\n    return ( \n      <div className=\"App\">\n        <Switch>\n          <Route path=\"/login\" render={(props) => <Login {...props} />} />\n          <Route path=\"/signup\" render={(props) => <Signup {...props} />} />\n          <Route path=\"/favorites\" render={(props) => <Favorites favorites={this.state.favorites} {...props} />} />\n          <PrivateRoute exact path=\"/\" addRecipe={this.addRecipe} addToFavorite={this.addToFavorite}/>\n          <Route render={() => <Redirect to=\"/\" />} />\n        </Switch>\n      </div>\n    );\n  }\n}\n\n\n"]},"metadata":{},"sourceType":"module"}